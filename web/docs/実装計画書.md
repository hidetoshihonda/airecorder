# AIボイスレコーダー 実装計画書・チケット管理

## 📋 概要

- **プロジェクト名**: Azure AI Voice Recorder & Real-time Translator
- **作成日**: 2026年2月5日
- **総開発期間**: 10週間（Phase 1-3）
- **開発ツール**: Azure MCP Server, GitHub MCP, Docker, GitHub Actions

---

## 🛠️ 開発環境・ツール構成

### MCP Server 構成

```json
{
  "mcpServers": {
    "azure-mcp-server": {
      "type": "stdio",
      "command": "npx",
      "args": ["-y", "@azure/mcp@latest", "server", "start"]
    },
    "github": {
      "type": "stdio",
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"]
    }
  }
}
```

### 開発ツールスタック

| ツール | 用途 |
|--------|------|
| **Azure MCP Server** | Azureリソースの作成・管理 |
| **GitHub MCP** | リポジトリ作成・ブランチ管理・PR操作 |
| **Azure Static Web Apps** | フロントエンドホスティング（自動CI/CD付き） |
| **Azure Functions** | バックエンドAPI |
| **Docker** | ローカル開発環境（Azuriteエミュレータ） |
| **GitHub Actions** | CI/CD パイプライン |
| **VS Code** | IDE |

---

## 📅 開発スケジュール概要

```
Week 1  ████████ 環境構築・Azureリソースセットアップ
Week 2  ████████ ユーザー認証（Azure AD B2C）
Week 3  ████████ 音声録音・ストレージ連携
Week 4  ████████ 文字起こし・翻訳機能
Week 5  ████████ 録音一覧・テスト
Week 6  ████████ AI要約・議事録機能
Week 7  ████████ 話者識別・エクスポート
Week 8  ████████ パフォーマンス最適化
Week 9  ████████ セキュリティ監査・負荷テスト
Week 10 ████████ ドキュメント・本番デプロイ
```

---

# 🎫 チケット一覧

## Phase 0: 事前準備

### TICKET-000: 開発環境セットアップ
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **担当**: -

#### タスク
- [ ] Node.js 20 LTS インストール確認
- [ ] Docker Desktop インストール・起動確認
- [ ] VS Code 拡張機能インストール
  - [ ] Azure Tools
  - [ ] Docker
  - [ ] ESLint
  - [ ] Prettier
  - [ ] GitLens
- [ ] Azure CLI インストール・ログイン確認
- [ ] GitHub CLI インストール・認証確認

#### MCP Server セットアップ
- [ ] Azure MCP Server 動作確認
  ```bash
  npx -y @azure/mcp@latest server start
  ```
- [ ] GitHub MCP Server 動作確認
  ```bash
  npx -y @modelcontextprotocol/server-github
  ```

#### 完了条件
- [ ] `az account show` でAzureアカウント情報が表示される
- [ ] `gh auth status` でGitHub認証が確認できる
- [ ] MCP Server経由でAzure/GitHub操作ができる

---

## Phase 1: MVP（Week 1-5）

---

### 🗓️ Week 1: 環境構築・Azureリソースセットアップ

---

### TICKET-001: GitHubリポジトリ作成
**優先度**: 🔴 最高 | **見積もり**: 30分 | **依存**: TICKET-000

#### タスク（GitHub MCP使用）
- [ ] リポジトリ作成: `airecorder`
- [ ] .gitignore 作成（Node.js テンプレート）
- [ ] README.md 作成
- [ ] ブランチ保護ルール設定（main）
- [ ] Issue テンプレート作成
- [ ] PR テンプレート作成

#### ブランチ戦略
```
main (本番)
  └── develop (開発)
        ├── feature/xxx (機能開発)
        ├── bugfix/xxx (バグ修正)
        └── hotfix/xxx (緊急修正)
```

#### 完了条件
- [ ] リポジトリが作成され、ローカルにcloneできる
- [ ] developブランチが作成されている

---

### TICKET-002: Azureリソースグループ作成
**優先度**: 🔴 最高 | **見積もり**: 15分 | **依存**: TICKET-000

#### タスク（Azure MCP使用）
- [ ] リソースグループ作成
  - 名前: `rg-airecorder-dev`
  - リージョン: `japaneast`
- [ ] タグ設定
  - Environment: Development
  - Project: AIRecorder

#### 完了条件
- [ ] Azure Portalでリソースグループが確認できる

---

### TICKET-003: Azure Key Vault 作成
**優先度**: 🔴 最高 | **見積もり**: 20分 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] Key Vault 作成
  - 名前: `kv-airecorder-dev`
  - SKU: Standard
- [ ] アクセスポリシー設定
- [ ] 診断設定有効化

#### 完了条件
- [ ] Key Vaultが作成され、シークレットの追加が可能

---

### TICKET-004: Azure AD B2C テナント作成
**優先度**: 🔴 最高 | **見積もり**: 1時間 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] Azure AD B2C テナント作成
  - 名前: `airecorderb2c`
  - ドメイン: `airecorderb2c.onmicrosoft.com`
- [ ] アプリ登録
  - 名前: `airecorder-web`
  - リダイレクトURI設定
- [ ] ユーザーフロー作成
  - サインアップ/サインイン (B2C_1_signupsignin)
  - パスワードリセット (B2C_1_passwordreset)
- [ ] ソーシャルIDプロバイダー設定
  - [ ] Google
  - [ ] Microsoft
  - [ ] Apple（オプション）

#### 取得する値（Key Vaultに保存）
- [ ] テナント名
- [ ] クライアントID
- [ ] クライアントシークレット

#### 完了条件
- [ ] テストユーザーでサインアップ/サインインができる

---

### TICKET-005: Azure Speech Services 作成
**優先度**: 🔴 最高 | **見積もり**: 15分 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] Speech Services リソース作成
  - 名前: `speech-airecorder-dev`
  - SKU: F0（無料枠）※本番はS0
  - リージョン: `japaneast`
- [ ] APIキー取得 → Key Vaultに保存

#### 完了条件
- [ ] Speech SDKでテスト音声認識ができる

---

### TICKET-006: Azure Translator 作成
**優先度**: 🔴 最高 | **見積もり**: 15分 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] Translator リソース作成
  - 名前: `translator-airecorder-dev`
  - SKU: F0（無料枠）
  - リージョン: `global`
- [ ] APIキー取得 → Key Vaultに保存

#### 完了条件
- [ ] テスト翻訳APIが動作する

---

### TICKET-007: Azure OpenAI Service 作成
**優先度**: 🟡 高 | **見積もり**: 30分 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] OpenAI Service リソース作成
  - 名前: `openai-airecorder-dev`
  - リージョン: `japaneast` または `eastus`
- [ ] モデルデプロイ
  - GPT-4 または GPT-4o
  - デプロイ名: `gpt-4-deployment`
- [ ] APIキー取得 → Key Vaultに保存

#### 完了条件
- [ ] Chat Completion APIが動作する

---

### TICKET-008: Azure Blob Storage 作成
**優先度**: 🔴 最高 | **見積もり**: 20分 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] ストレージアカウント作成
  - 名前: `stairecorderdev`
  - SKU: Standard_LRS
  - アクセス層: Hot
- [ ] コンテナ作成
  - `recordings` (音声ファイル)
  - `transcripts` (文字起こしデータ)
- [ ] CORS設定
- [ ] 接続文字列取得 → Key Vaultに保存

#### 完了条件
- [ ] ファイルのアップロード/ダウンロードが動作する

---

### TICKET-009: Azure Cosmos DB 作成
**優先度**: 🔴 最高 | **見積もり**: 20分 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] Cosmos DB アカウント作成
  - 名前: `cosmos-airecorder-dev`
  - API: NoSQL
  - 容量モード: サーバーレス（コスト最適化）
- [ ] データベース作成
  - 名前: `airecorder`
- [ ] コンテナ作成
  - `recordings` (パーティションキー: /userId)
  - `users` (パーティションキー: /id)
- [ ] 接続文字列取得 → Key Vaultに保存

#### 完了条件
- [ ] ドキュメントのCRUD操作が動作する

---

### TICKET-010: Azure Container Registry 作成 ~~（オプション）~~ ❌ 不要
**優先度**: ~~⚪ 低~~ | **状態**: ❌ **不要（スキップ）**

> ❌ **不要**: Azure Static Web Apps + Azure Functions を使用するため、コンテナは不要。
> GitHub Actions から直接デプロイするアーキテクチャを採用。

#### ~~タスク~~ → スキップ
- ~~ACR 作成~~
- ~~管理者ユーザー有効化~~
- ~~認証情報取得~~

#### 完了条件
- [ ] `docker push` でイメージをプッシュできる

---

### TICKET-011: Azure Static Web Apps 作成
**優先度**: 🔴 最高 | **見積もり**: 30分 | **依存**: TICKET-002

#### タスク（Azure MCP使用）
- [ ] Static Web Apps 作成
  - 名前: `swa-airecorder-dev`
  - リージョン: `eastasia`
  - SKU: Free
- [ ] GitHubリポジトリ連携
- [ ] ビルド設定
  - app_location: `/web`
  - output_location: `.next`
  - api_location: `/api` (Azure Functions)
- [ ] 環境変数設定

#### 完了条件
- [ ] GitHubプッシュでStatic Web Appsに自動デプロイされる

---

### TICKET-012: Azure Functions 作成
**優先度**: 🟡 高 | **見積もり**: 20分 | **依存**: TICKET-008

#### タスク（Azure MCP使用）
- [ ] Function App 作成
  - 名前: `func-airecorder-dev`
  - ランタイム: Node.js 20
  - プラン: Consumption
- [ ] ストレージアカウント連携
- [ ] Application Insights 有効化

#### 完了条件
- [ ] サンプルFunctionがデプロイ・実行できる

---

### TICKET-013: GitHub Actions シークレット設定
**優先度**: 🔴 最高 | **見積もり**: 30分 | **依存**: TICKET-010, TICKET-011

#### タスク（GitHub MCP使用）
- [ ] サービスプリンシパル作成
  ```bash
  az ad sp create-for-rbac --name "sp-airecorder-github" \
    --role contributor \
    --scopes /subscriptions/{subscription-id}/resourceGroups/rg-airecorder-dev \
    --sdk-auth
  ```
- [ ] GitHub Secrets 設定
  - [ ] `AZURE_CREDENTIALS`
  - [ ] `AZURE_STATIC_WEB_APPS_API_TOKEN`

#### 完了条件
- [ ] GitHub ActionsからAzureへの認証が成功する

---

### TICKET-014: プロジェクト初期化
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-001

#### タスク
- [ ] Next.js 15 プロジェクト作成
  ```bash
  npx create-next-app@latest web --typescript --tailwind --eslint --app
  ```
- [ ] 必要なパッケージインストール
  - [ ] @azure/msal-browser, @azure/msal-react
  - [ ] microsoft-cognitiveservices-speech-sdk
  - [ ] @azure/storage-blob
  - [ ] @azure/cosmos
  - [ ] zod, react-hook-form
  - [ ] Radix UI コンポーネント
- [ ] ESLint/Prettier 設定
- [ ] Tailwind CSS 設定
- [ ] 環境変数ファイル作成 (.env.local.example)

#### ディレクトリ構成
```
airecorder/
├── .github/
│   └── workflows/
│       └── deploy.yml
├── web/
│   ├── src/
│   │   ├── app/
│   │   ├── components/
│   │   ├── hooks/
│   │   ├── lib/
│   │   ├── services/
│   │   └── types/
│   ├── Dockerfile
│   └── package.json
├── api/  (Azure Functions)
├── docker-compose.yml
└── README.md
```

#### 完了条件
- [ ] `npm run dev` でローカル起動できる
- [ ] Dockerイメージがビルドできる

---

### TICKET-015: ローカル開発環境構築（Docker/Azurite） ❌ 不要
**優先度**: ~~🟡 高~~ | **状態**: ❌ **不要（スキップ）**

> ❌ **不要**: 実際の Azure サービス（無料枠）を使用して開発中。
> Azurite エミュレータは不要。オフライン開発が必要な場合のみ検討。

#### ~~タスク~~ → スキップ
- ~~docker-compose.yml 作成~~
- ~~Azurite 設定~~

#### 現在の開発環境
- `npm run dev` でローカル開発 ✅
- 実際の Azure サービス（Speech, Translator, OpenAI, Cosmos DB）を使用 ✅

---

### TICKET-016: CI/CD パイプライン構築
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-013, TICKET-014

#### タスク
- [ ] .github/workflows/azure-static-web-apps.yml 作成
  - Lint ジョブ
  - Test ジョブ
  - Static Web Apps デプロイジョブ
- [ ] PRトリガー設定（プレビュー環境作成）
- [ ] mainブランチマージ時の自動デプロイ

#### 完了条件
- [ ] PRでCIが実行される
- [ ] mainマージでStatic Web Appsに自動デプロイされる

---

### TICKET-017: 基本UI/レイアウト作成
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: TICKET-014

#### タスク
- [ ] 共通レイアウトコンポーネント作成
  - Header
  - Footer
  - Navigation
- [ ] ページ作成（スケルトン）
  - `/` ホーム
  - `/record` 録音画面
  - `/recordings` 録音一覧
  - `/recordings/[id]` 録音詳細
  - `/settings` 設定
- [ ] Distinctionサイト参考のデザインシステム
  - カラーパレット
  - タイポグラフィ
  - スペーシング

#### 完了条件
- [ ] 全ページ間のナビゲーションが動作する
- [ ] レスポンシブデザインが適用されている

---

### 🗓️ Week 2: ユーザー認証

---

### TICKET-018: MSAL認証設定
**優先度**: 🔴 最高 | **見積もり**: 3時間 | **依存**: TICKET-004, TICKET-014

#### タスク
- [ ] MSAL設定ファイル作成
- [ ] AuthProvider コンポーネント作成
- [ ] useAuth カスタムフック作成
- [ ] ProtectedRoute コンポーネント作成

#### 完了条件
- [ ] Azure AD B2Cでのサインインが動作する

---

### TICKET-019: ログイン/サインアップUI
**優先度**: 🔴 最高 | **見積もり**: 3時間 | **依存**: TICKET-018

#### タスク
- [ ] ログインページ作成
- [ ] サインアップページ作成
- [ ] ソーシャルログインボタン
- [ ] エラーハンドリング

#### 完了条件
- [ ] メール/パスワードでサインアップできる
- [ ] Google/Microsoftでログインできる

---

### TICKET-020: ユーザープロファイル管理
**優先度**: 🟡 高 | **見積もり**: 2時間 | **依存**: TICKET-018, TICKET-009

#### タスク
- [ ] ユーザー設定画面
- [ ] Cosmos DBへのユーザーデータ保存
- [ ] デフォルト言語設定

#### 完了条件
- [ ] ユーザー設定が保存・読み込みできる

---

### 🗓️ Week 3: 音声録音・ストレージ連携

---

### TICKET-021: 音声録音機能
**優先度**: 🔴 最高 | **見積もり**: 4時間 | **依存**: TICKET-017

#### タスク
- [ ] MediaRecorder API ラッパー作成
- [ ] useRecorder カスタムフック
- [ ] 録音UI（開始/停止/一時停止）
- [ ] 録音時間表示
- [ ] 音声波形表示（オプション）

#### 完了条件
- [ ] ブラウザでの音声録音が動作する

---

### TICKET-022: Azure Blob Storage連携
**優先度**: 🔴 最高 | **見積もり**: 3時間 | **依存**: TICKET-008, TICKET-021

#### タスク
- [ ] BlobServiceClient 設定
- [ ] SASトークン生成API
- [ ] ファイルアップロード処理
- [ ] アップロードプログレス表示

#### 完了条件
- [ ] 録音ファイルがBlob Storageにアップロードされる

---

### TICKET-023: 録音メタデータ保存
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-009, TICKET-022

#### タスク
- [ ] Recording データモデル実装
- [ ] Cosmos DB CRUD操作
- [ ] 録音完了時のメタデータ保存

#### 完了条件
- [ ] 録音情報がCosmos DBに保存される

---

### TICKET-024: 音声再生機能
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-022

#### タスク
- [ ] AudioPlayer コンポーネント
- [ ] 再生/停止/シーク
- [ ] 再生速度変更

#### 完了条件
- [ ] Blob Storageの音声ファイルを再生できる

---

### 🗓️ Week 4: 文字起こし・翻訳機能

---

### TICKET-025: Azure Speech SDK連携
**優先度**: 🔴 最高 | **見積もり**: 4時間 | **依存**: TICKET-005, TICKET-021

#### タスク
- [ ] Speech SDK 初期化
- [ ] リアルタイム音声認識設定
- [ ] 10言語対応設定
- [ ] useSpeechRecognition カスタムフック

#### 完了条件
- [ ] リアルタイムで文字起こしが表示される

---

### TICKET-026: 翻訳機能実装
**優先度**: 🔴 最高 | **見積もり**: 3時間 | **依存**: TICKET-006, TICKET-025

#### タスク
- [ ] Translator API クライアント
- [ ] 言語選択UI（10言語）
- [ ] リアルタイム翻訳処理
- [ ] 翻訳結果表示

#### 完了条件
- [ ] 文字起こしテキストがリアルタイムで翻訳される

---

### TICKET-027: 録音画面統合
**優先度**: 🔴 最高 | **見積もり**: 4時間 | **依存**: TICKET-025, TICKET-026

#### タスク
- [ ] 録音+文字起こし+翻訳の統合UI
- [ ] 入力言語/翻訳先言語選択
- [ ] 文字起こし/翻訳パネル表示
- [ ] 録音完了時の保存処理

#### 完了条件
- [ ] 録音画面で全機能が動作する

---

### 🗓️ Week 5: 録音一覧・テスト

---

### TICKET-028: 録音一覧画面
**優先度**: 🔴 最高 | **見積もり**: 3時間 | **依存**: TICKET-023

#### タスク
- [ ] 録音一覧取得API
- [ ] 録音カード コンポーネント
- [ ] 日付/タイトルでのソート
- [ ] ページネーション

#### 完了条件
- [ ] 過去の録音一覧が表示される

---

### TICKET-029: 録音詳細画面
**優先度**: 🔴 最高 | **見積もり**: 3時間 | **依存**: TICKET-024, TICKET-028

#### タスク
- [ ] 録音詳細ページ
- [ ] 音声再生 + 文字起こし表示
- [ ] 翻訳表示
- [ ] 録音の削除機能

#### 完了条件
- [ ] 録音の詳細情報が確認できる

---

### TICKET-030: 単体テスト作成
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: TICKET-027

#### タスク
- [ ] Jest 設定
- [ ] コンポーネントテスト
- [ ] カスタムフックテスト
- [ ] API関数テスト

#### 完了条件
- [ ] テストカバレッジ 70%以上

---

### TICKET-031: E2Eテスト作成
**優先度**: 🟡 高 | **見積もり**: 3時間 | **依存**: TICKET-029

#### タスク
- [ ] Playwright 設定
- [ ] 認証フローテスト
- [ ] 録音フローテスト
- [ ] 一覧/詳細フローテスト

#### 完了条件
- [ ] 主要フローのE2Eテストが通る

---

### TICKET-032: バグ修正・調整
**優先度**: 🟡 高 | **見積もり**: 8時間 | **依存**: TICKET-030, TICKET-031

#### タスク
- [ ] テストで発見されたバグ修正
- [ ] UI/UX調整
- [ ] パフォーマンスチューニング

#### 完了条件
- [ ] 全テストがグリーン
- [ ] MVP機能が安定動作

---

## Phase 2: 機能拡張（Week 6-8）

---

### 🗓️ Week 6: AI要約・議事録機能

---

### TICKET-033: Azure OpenAI 連携
**優先度**: 🟡 高 | **見積もり**: 3時間 | **依存**: TICKET-007

#### タスク
- [ ] OpenAI API クライアント
- [ ] プロンプトテンプレート作成
- [ ] レート制限ハンドリング

#### 完了条件
- [ ] GPT-4 API呼び出しが動作する

---

### TICKET-034: 要約機能実装
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: TICKET-033

#### タスク
- [ ] 要約生成ロジック
- [ ] 要約UIコンポーネント
- [ ] 生成中のローディング表示
- [ ] 要約の保存

#### 完了条件
- [ ] 録音から要約が生成される

---

### TICKET-035: 議事録生成機能
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: TICKET-034

#### タスク
- [ ] 議事録フォーマット定義
- [ ] ToDo抽出プロンプト
- [ ] キーポイント抽出
- [ ] 議事録UIコンポーネント

#### 完了条件
- [ ] 構造化された議事録が生成される

---

### 🗓️ Week 7: 話者識別・エクスポート

---

### TICKET-036: 話者識別機能
**優先度**: 🟢 中 | **見積もり**: 4時間 | **依存**: TICKET-025

#### タスク
- [ ] Speaker Diarization 設定
- [ ] 話者ラベル表示
- [ ] 話者ごとの色分け

#### 完了条件
- [ ] 複数話者が識別・表示される

---

### TICKET-037: エクスポート機能
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: TICKET-035

#### タスク
- [ ] テキストファイルエクスポート
- [ ] PDF生成（react-pdf）
- [ ] Wordファイル生成（docx）

#### 完了条件
- [ ] 3形式でエクスポートできる

---

### 🗓️ Week 8: パフォーマンス最適化

---

### TICKET-038: パフォーマンス最適化
**優先度**: 🟡 高 | **見積もり**: 6時間 | **依存**: TICKET-037

#### タスク
- [ ] バンドルサイズ最適化
- [ ] 画像/アセット最適化
- [ ] API呼び出しキャッシュ
- [ ] Lazy Loading実装

#### 完了条件
- [ ] Lighthouse スコア 90以上

---

### TICKET-039: 全言語品質テスト
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: TICKET-026

#### タスク
- [ ] 10言語の音声認識テスト
- [ ] 翻訳品質確認
- [ ] UI多言語表示確認

#### 完了条件
- [ ] 全言語で主要機能が動作する

---

## Phase 3: 品質向上・リリース準備（Week 9-10）

---

### 🗓️ Week 9: セキュリティ・負荷テスト

---

### TICKET-040: セキュリティ監査
**優先度**: 🔴 最高 | **見積もり**: 4時間 | **依存**: -

#### タスク
- [ ] 依存パッケージ脆弱性チェック
- [ ] OWASP Top 10 確認
- [ ] 認証/認可フローレビュー
- [ ] データ暗号化確認

#### 完了条件
- [ ] 重大な脆弱性がない

---

### TICKET-041: 負荷テスト
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: -

#### タスク
- [ ] k6 / Artillery 設定
- [ ] API負荷テスト
- [ ] 同時接続テスト
- [ ] ボトルネック特定・改善

#### 完了条件
- [ ] 100同時ユーザーで安定動作

---

### 🗓️ Week 10: ドキュメント・本番デプロイ

---

### TICKET-042: ドキュメント整備
**優先度**: 🟡 高 | **見積もり**: 4時間 | **依存**: -

#### タスク
- [ ] README.md 更新
- [ ] API ドキュメント
- [ ] デプロイ手順書
- [ ] ユーザーマニュアル（簡易版）

#### 完了条件
- [ ] 新規開発者がセットアップできる

---

### TICKET-043: 本番環境構築
**優先度**: 🔴 最高 | **見積もり**: 4時間 | **依存**: TICKET-040

#### タスク（Azure MCP使用）
- [ ] 本番リソースグループ作成
- [ ] 本番用Azureリソース作成
- [ ] カスタムドメイン設定
- [ ] SSL証明書設定

#### 完了条件
- [ ] 本番URLでアクセスできる

---

### TICKET-044: 本番デプロイ・動作確認
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-043

#### タスク
- [ ] 本番デプロイ実行
- [ ] スモークテスト
- [ ] 監視設定確認

#### 完了条件
- [ ] 本番環境で全機能が動作する

---

---

## 🌐 Phase 4: 双方向自動言語検出同時通訳（追加機能）

> **概要**: TALIX/DingTalk A1のような自動言語検出による双方向リアルタイム通訳機能を実装。
> 話者が日本語で話せば英語に、英語で話せば日本語に自動翻訳+音声出力する。

---

### TICKET-050: 自動言語検出対応 Speech Recognition Hook 実装
**優先度**: 🔴 最高 | **見積もり**: 3時間 | **依存**: なし（既存機能拡張）

#### 概要
Azure Speech SDK の `AutoDetectSourceLanguage` 機能を使用して、発話言語を自動検出する。

#### タスク
- [ ] `useBidirectionalSpeechRecognition.ts` フック新規作成
- [ ] `AutoDetectSourceLanguageConfig` の設定
  - 検出対象言語の設定（日本語、英語、中国語など最大4言語）
- [ ] 認識結果に検出言語情報を含める
- [ ] 言語検出信頼度スコアの取得
- [ ] 既存の `useSpeechRecognition` との共通化/リファクタリング

#### 技術詳細
```typescript
import * as SpeechSDK from "microsoft-cognitiveservices-speech-sdk";

// 自動言語検出の設定
const autoDetectConfig = SpeechSDK.AutoDetectSourceLanguageConfig.fromLanguages([
  "ja-JP",
  "en-US",
  "zh-CN",
  "ko-KR"
]);

// SpeechRecognizerの作成（言語自動検出）
const recognizer = SpeechSDK.SpeechRecognizer.FromConfig(
  speechConfig,
  autoDetectConfig,
  audioConfig
);

// 検出された言語の取得
recognizer.recognized = (s, e) => {
  const autoDetectResult = SpeechSDK.AutoDetectSourceLanguageResult.fromResult(e.result);
  const detectedLanguage = autoDetectResult.language; // "ja-JP" or "en-US" etc.
  const confidence = autoDetectResult.languageDetectionConfidence;
};
```

#### 完了条件
- [ ] 日本語/英語の発話が自動検出される
- [ ] 検出言語コードが正しく返却される
- [ ] 信頼度スコアが取得できる

---

### TICKET-051: 双方向翻訳ロジック実装
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-050

#### 概要
検出された言語に基づき、ターゲット言語を自動決定して翻訳する。

#### タスク
- [ ] 言語ペア設定の状態管理追加
  - 例: 日本語 ↔ 英語、日本語 ↔ 中国語
- [ ] 検出言語→翻訳先言語のマッピングロジック
  ```typescript
  // languagePair: ["ja-JP", "en-US"]
  const targetLanguage = detectedLanguage === languagePair[0] 
    ? languagePair[1] 
    : languagePair[0];
  ```
- [ ] 信頼度スコアが低い場合のフォールバック処理
- [ ] 翻訳結果に元言語・翻訳先言語情報を付与

#### UI表示例
```
[検出: 日本語] こんにちは
[翻訳: 英語] Hello

[検出: English] How are you?
[翻訳: 日本語] お元気ですか？
```

#### 完了条件
- [ ] 日本語→英語、英語→日本語の双方向翻訳が動作
- [ ] 翻訳結果に言語情報が表示される

---

### TICKET-052: TTS自動言語切り替え実装
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-051

#### 概要
翻訳結果の言語に応じて適切な音声で読み上げる。

#### タスク
- [ ] 言語→音声名マッピング拡張
  ```typescript
  const voiceMap: Record<string, string> = {
    "ja-JP": "ja-JP-NanamiNeural",
    "en-US": "en-US-JennyNeural",
    "zh-CN": "zh-CN-XiaoxiaoNeural",
    "ko-KR": "ko-KR-SunHiNeural",
  };
  ```
- [ ] `useTextToSpeech` フックの言語動的切り替え対応
- [ ] 翻訳完了後の自動TTS再生オプション

#### 完了条件
- [ ] 英語翻訳は英語音声、日本語翻訳は日本語音声で再生される
- [ ] 自動再生ON/OFFが切り替えられる

---

### TICKET-053: エコー/ループ防止機構実装
**優先度**: 🔴 最高 | **見積もり**: 2時間 | **依存**: TICKET-052

#### 概要
TTS再生中にマイクが拾わないようにする（自分の翻訳音声を再翻訳してしまうのを防ぐ）。

#### タスク
- [ ] TTS再生開始時にマイク入力を一時停止
- [ ] TTS再生終了後にマイク入力を自動再開
- [ ] 再開時の遅延調整（エコー完全消去のため+500ms）
- [ ] 手動ミュートボタンの追加
- [ ] ステータスインジケーター表示
  - 🎤 聴取中
  - 🔊 再生中
  - ⏸️ 一時停止中

#### 技術詳細
```typescript
const handleTranslationComplete = async (translatedText: string, targetLang: string) => {
  // 1. マイク一時停止
  pauseListening();
  
  // 2. TTS再生
  await speak(translatedText, targetLang);
  
  // 3. エコー消去のため少し待機
  await new Promise(resolve => setTimeout(resolve, 500));
  
  // 4. マイク再開
  resumeListening();
};
```

#### 完了条件
- [ ] TTS再生中はマイクが自動ミュートされる
- [ ] TTS終了後に自動でマイクが再開する
- [ ] 翻訳ループが発生しない

---

### TICKET-054: 双方向通訳UIコンポーネント実装
**優先度**: 🔴 最高 | **見積もり**: 4時間 | **依存**: TICKET-050, TICKET-051, TICKET-052, TICKET-053

#### 概要
通訳モード専用の新しいUIを実装。

#### タスク
- [ ] 新規ページ `/interpreter` 作成
- [ ] 言語ペア選択UI
  ```
  [日本語 🇯🇵] ⟷ [English 🇺🇸]  ▼
  ```
- [ ] 双方向会話表示エリア
  - 左右分割または上下スレッド形式
  - 話者ごとの色分け
  - 言語アイコン表示
- [ ] リアルタイム波形表示（オプション）
- [ ] 操作ボタン
  - ▶️ 開始 / ⏹️ 停止
  - 🔇 ミュート
  - 🔊 音量調整
  - ⚙️ 設定
- [ ] ナビゲーションに「通訳モード」を追加

#### UI案（会話スレッド形式）
```
┌─────────────────────────────────────────────┐
│  🌐 双方向通訳                    ⚙️        │
├─────────────────────────────────────────────┤
│  [日本語 🇯🇵] ⟷ [English 🇺🇸]              │
├─────────────────────────────────────────────┤
│                                             │
│  🇯🇵 こんにちは、今日の議題について...       │
│  🇺🇸 Hello, regarding today's agenda...     │
│                                             │
│  🇺🇸 I have a question about the budget.    │
│  🇯🇵 予算について質問があります。            │
│                                             │
│  🇯🇵 もちろん、説明します。                  │
│  🇺🇸 Of course, I'll explain.               │
│                                             │
├─────────────────────────────────────────────┤
│  🎤 聴取中...                               │
│  [    ▶️ 開始    ] [🔇] [🔊━━━━●━━]         │
└─────────────────────────────────────────────┘
```

#### 完了条件
- [ ] `/interpreter` ページが動作する
- [ ] 言語ペアが選択できる
- [ ] 双方向の会話が見やすく表示される
- [ ] ナビゲーションからアクセスできる

---

### TICKET-055: 通訳セッション保存機能
**優先度**: 🟡 高 | **見積もり**: 2時間 | **依存**: TICKET-054

#### 概要
通訳セッションの会話履歴を保存・エクスポートできるようにする。

#### タスク
- [ ] 通訳セッションデータモデル定義
  ```typescript
  interface InterpreterSession {
    id: string;
    languagePair: [string, string];
    startTime: Date;
    endTime?: Date;
    conversations: ConversationItem[];
  }

  interface ConversationItem {
    timestamp: number;
    detectedLanguage: string;
    originalText: string;
    translatedLanguage: string;
    translatedText: string;
  }
  ```
- [ ] Cosmos DB への保存API追加
- [ ] セッション履歴一覧ページ
- [ ] テキストエクスポート（対訳形式）

#### 完了条件
- [ ] 通訳セッションが保存される
- [ ] 履歴から過去のセッションが閲覧できる
- [ ] テキストエクスポートができる

---

### TICKET-056: 言語検出精度向上・フォールバック機構
**優先度**: 🟡 高 | **見積もり**: 2時間 | **依存**: TICKET-050

#### 概要
短い発話や曖昧な言語での誤検出を軽減する。

#### タスク
- [ ] 信頼度スコア閾値の設定（例: 0.7以上で自動判定）
- [ ] 閾値以下の場合の挙動
  - 前回の検出言語を維持
  - ユーザーに確認プロンプト表示
- [ ] 言語ヒント機能（最初に話す言語を指定）
- [ ] 連続同一言語検出の安定化
- [ ] 誤検出時の手動補正UI

#### 完了条件
- [ ] 信頼度が低い場合に適切なフォールバックが動作
- [ ] 誤検出が最小限に抑えられる

---

### TICKET-057: マルチデバイス対応（将来拡張）
**優先度**: 🟢 中 | **見積もり**: 4時間 | **依存**: TICKET-054

#### 概要
2台のデバイスで各話者が自分のデバイスを使用するモード。

#### タスク
- [ ] WebSocket/WebRTC によるリアルタイム同期
- [ ] セッションID共有（QRコード/リンク）
- [ ] 各デバイスは自分の言語で発話
- [ ] 相手の翻訳結果を受信して表示・再生

#### アーキテクチャ
```
[デバイスA: 日本語話者]          [デバイスB: 英語話者]
       │                              │
       │  ←── WebSocket/WebRTC ───→   │
       │                              │
[Azure SignalR Service / Azure Web PubSub]
```

#### 完了条件
- [ ] 2台のデバイスで双方向通訳ができる
- [ ] 遅延が最小限（500ms以内）

---

### TICKET-058: 通訳品質向上（オプション）
**優先度**: 🟢 中 | **見積もり**: 3時間 | **依存**: TICKET-055

#### 概要
用語集・専門用語対応で翻訳精度を向上。

#### タスク
- [ ] カスタム用語集機能
  - ユーザー定義の単語ペア
  - 業界専門用語
- [ ] Azure Translator カスタム翻訳設定
- [ ] コンテキスト考慮（過去の会話を翻訳APIに渡す）

#### 完了条件
- [ ] 用語集が設定できる
- [ ] 専門用語が正しく翻訳される

---

## 📊 チケットサマリー

### Phase別チケット数

| Phase | チケット数 | 見積もり時間 |
|-------|-----------|-------------|
| Phase 0 | 1 | 2時間 |
| Phase 1 (Week 1-5) | 32 | 約60時間 |
| Phase 2 (Week 6-8) | 7 | 約29時間 |
| Phase 3 (Week 9-10) | 5 | 約18時間 |
| **Phase 4 (双方向通訳)** | **9** | **約24時間** |
| **合計** | **54** | **約133時間** |

### 優先度別

| 優先度 | チケット数 |
|--------|-----------|
| 🔴 最高 | 30 |
| 🟡 高 | 19 |
| 🟢 中 | 5 |

---

## 📋 Phase 4 実装順序（推奨）

```
TICKET-050 (自動言語検出) ──┐
                          ├─→ TICKET-051 (双方向翻訳ロジック)
                          │        │
                          │        ▼
                          │   TICKET-052 (TTS言語切替)
                          │        │
                          │        ▼
                          │   TICKET-053 (エコー防止)
                          │        │
                          ▼        ▼
               TICKET-054 (UI実装) ◀──────┘
                    │
                    ├─→ TICKET-055 (セッション保存)
                    │
                    ├─→ TICKET-056 (検出精度向上)
                    │
                    ├─→ TICKET-057 (マルチデバイス) [将来]
                    │
                    └─→ TICKET-058 (品質向上) [オプション]
```

### MVP（最小限で動く双方向通訳）
1. **TICKET-050**: 自動言語検出 (3h)
2. **TICKET-051**: 双方向翻訳 (2h)
3. **TICKET-052**: TTS言語切替 (2h)
4. **TICKET-053**: エコー防止 (2h)
5. **TICKET-054**: UI実装 (4h)

**MVP合計: 約13時間**

---

## 🔄 進捗管理

### ステータス定義

| ステータス | 説明 |
|-----------|------|
| ⬜ TODO | 未着手 |
| 🔄 In Progress | 作業中 |
| 👀 Review | レビュー待ち |
| ✅ Done | 完了 |
| ⏸️ Blocked | ブロック中 |

---

**文書情報**
- 作成日: 2026年2月5日
- バージョン: 1.1
- 最終更新: 2026年2月6日

---


#  Phase 5: ?????????

> **???????????**: [?????????.md](?????????.md)

### ??
???????????????????Azure Conversation Transcription ?????**??????????**???????

### ??????

| ???? | ???? | ?? | ??? |
|---------|---------|------|--------|
| TICKET-060 | ConversationTranscriber ???? | 4h |  ?? |
| TICKET-061 | ??????????? | 3h |  ?? |
| TICKET-062 | ???? UI ??????? | 4h |  ?? |
| TICKET-063 | ????????? | 3h |  ? |
| TICKET-064 | Voice Profile ??(?????) | 5h |  ? |
| TICKET-065 | ?????????? | 3h |  ? |

**MVP??**: 14?? | **????**: 22??
